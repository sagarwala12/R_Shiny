---
title: "R Notebook"
output: html_notebook
---






```{r}
library(googleVis)
library(tidyverse)
library(dplyr)
cases_state <- read.csv('./data/statewide_cases.csv')
state_test <- read.csv('./data/statewide_testing.csv')
cases_age <- read.csv('./data/case_demographics_age.csv')
cases_ethnic<- read.csv('./data/case_demographics_ethnicity.csv')
cases_sex <- read.csv('./data/case_demographics_sex.csv')
hospitals <- read.csv('./data/hospitals_by_county.csv')


#indexing age, sex, ethnic background to cases statewide. By using the date as ID we can create separate data frames of each factor by the county it was located within.
ca_age <- merge(cases_state, cases_age, by = "date")

ca_sex <- merge(cases_state, cases_sex, by = "date") 

ca_ethnic <- merge(cases_state, cases_ethnic, by = "date")

```


```{r Plot for number of tested}
state_test_line <- gvisLineChart(state_test[,c("date", "tested")])
plot(state_test_line)
```




```{r}
CityPopularity3 <- data.frame(City = "Los Angeles",
                              Popularity = 600)

Geo3 <- gvisGeoChart(CityPopularity3, 
                     locationvar='City',
                     colorvar='Popularity',
                     options=list(region = 'US-CA',
                                  resolution = "provinces",
                                  height=350,
                                  displayMode='markers', 
                                  colorAxis="{values:[200,400,600,800], colors:[\'red', \'pink\', \'orange',\'green']}"))

plot(Geo3)
                      
```







```{r}
M <- gvisMotionChart(Fruits, "Fruit", "Year",
                     options=list(width=600, height=400))
print(M, file = "figs/gvis1.html")
plot(M)
```




```{r}
df <- data.frame(country=c("US", "GB", "BR"),
val1=c(1,3,4),
val2=c(23,12,32))
## Bar chart
Bar1 <- gvisBarChart(df, xvar="country", yvar=c("val1", "val2"))
plot(Bar1)
## Stacked bar chart
Bar2 <- gvisBarChart(df, xvar="country", yvar=c("val1", "val2"),
options=list(isStacked=TRUE))
plot(Bar2)
## Add a customised title and change width of bars
Bar3 <- gvisBarChart(df, xvar="country", yvar=c("val1", "val2"),
options=list(title="Hello World",
titleTextStyle="{color:'red',fontName:'Courier',fontSize:16}",
bar="{groupWidth:'100%'}"))
plot(Bar3)
## Not run:
## Change x-axis to percentages
Bar4 <- gvisBarChart(df, xvar="country", yvar=c("val1", "val2"),
options=list(hAxis="{format:'#,###%'}"))
plot(Bar4)


```








```{r}
require(rCharts)
haireye = as.data.frame(HairEyeColor)
n1=nPlot(Freq ~ Hair, group = 'Eye', type = 'multiBarChart', data = subset(haireye, Sex == 'Male'))
n1
```


```{r}





n2=nPlot(xvar= "age_group", yvar = c("val1", "val2") , type = 'multiBarChart', data = age_plot)
n2

```


```{r}
iris %>%                                        # Specify data frame
  group_by(Species) %>%                         # Specify group indicator
  summarise_at(vars(Sepal.Length),              # Specify column
               list(name = sum))  
```

```{r age_plot}
age_plot <- select(cases_age, "age_group", "totalpositive", "deaths", "deaths_percent")
age_plota <- age_plot %>% 
  group_by(age_group) %>% 
  summarise_at(vars(totalpositive),
               list(totalpositive = sum))
age_plotb <- age_plot %>% 
  group_by(age_group) %>% 
  summarise_at("deaths",
               funs(deaths = sum),
               na.rm=TRUE)

age_plotc <-age_plot %>% 
  group_by(age_group) %>% 
  summarise_at("deaths_percent",
               funs(deaths_percent = mean),
               na.rm=TRUE)

age_plot <- merge(age_plota, age_plotb, by = "age_group")
age_plot <- merge(age_plot, age_plotc, by = "age_group")

Bar1 <- gvisBarChart(age_plot, xvar="age_group", yvar=c("totalpositive", "deaths", "deaths_percent"),
                     options=list(title="Age Demographics",
                          titleTextStyle="{color:'Black',fontName:'Courier',fontSize:16}",
                          width="auto", height="auto",
                          legend = "bottom",
                          bar="{groupWidth:'100%'}"))
                     
                     
                     
plot(Bar1)

```

```{r}
df <- data.frame(country=c("US", "GB", "BR"), 
                           val1=c(1,3,4), 
                           val2=c(23,12,32))

## Bar chart
Bar1 <- gvisBarChart(df, xvar="country", yvar=c("val1", "val2"))
plot(Bar1)

## Stacked bar chart
Bar2 <- gvisBarChart(df, xvar="country", yvar=c("val1", "val2"),
     options=list(isStacked=TRUE))
plot(Bar2)


## Add a customised title and change width of bars
Bar3 <- gvisBarChart(df, xvar="country", yvar=c("val1", "val2"),
             options=list(title="Hello World",
                          titleTextStyle="{color:'red',fontName:'Courier',fontSize:16}",
                          bar="{groupWidth:'100%'}"))
plot(Bar3)

## Not run: 
# ## Change x-axis to percentages
# Bar4 <- gvisBarChart(df, xvar="country", yvar=c("val1", "val2"),
#                        options=list(hAxis="{format:'#,###%'}"))
# plot(Bar4)
```

